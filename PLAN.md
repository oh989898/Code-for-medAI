# 医学 AI 节点化工具箱工程任务拆分（详细版）

> 目标：构建面向实验室成员（含新手）的“节点化医学 AI 工具箱”，支持多模态数据输入、隐空间表征学习、基础模型与下游任务的快速配置与代码生成。

## 0. 里程碑概览

- **M0：需求与技术选型**（1–2 周）
- **M1：最小可用产品（MVP）**（3–5 周）
- **M2：多模态数据与基础模型接入**（4–6 周）
- **M3：隐空间表征与可解释性扩展**（4–6 周）
- **M4：插件生态与实验室推广**（持续迭代）

---

## 1. 产品与需求细化（M0）

### 1.1 用户需求访谈与场景梳理
- [ ] 典型使用场景：
  - 影像分类/分割（CT、MRI、超声）
  - 病理图像分割/检测（WSI）
  - 影像+文本多模态诊断
  - 自监督/对比学习的隐空间表征
- [ ] 角色与权限：
  - 新手用户：可视化拖拽、只看模板与结果
  - 进阶用户：可调参、可替换模型与数据管道
- [ ] 输出需求：
  - 生成可运行的训练/推理代码
  - 生成 pipeline 配置文件
  - 自动输出日志与可视化（训练曲线、指标）

### 1.2 需求文档与原型
- [ ] 编写 PRD（需求文档）
- [ ] 低保真原型（节点面板/属性面板/结果面板）
- [ ] 交互流程：节点拖拽→连线→参数配置→生成代码→运行

### 1.3 技术选型与架构方案
- [ ] 前端：React + React Flow（或 Rete.js）
- [ ] 后端：Python FastAPI + Pydantic
- [ ] 代码生成：Jinja2 + Node Schema
- [ ] 训练框架：PyTorch / Lightning
- [ ] 数据处理：MONAI / SimpleITK / OpenSlide

---

## 2. MVP 基础功能（M1）

### 2.1 前端基础节点画布
- [ ] 节点创建/删除/拖拽/连线
- [ ] 节点分类与搜索（数据/模型/训练/评估）
- [ ] 节点属性面板（参数输入）
- [ ] 节点图保存为 JSON

### 2.2 Node Schema 规范
- [ ] 定义节点元数据结构：
  - `name` / `category` / `inputs` / `outputs`
  - `params`（可编辑）
  - `code_template`（代码片段）
- [ ] 统一输入输出类型：
  - 图像张量 / 文本 / 结构化表格

### 2.3 代码生成引擎
- [ ] JSON -> Python pipeline
- [ ] 代码模块化：
  - data.py / model.py / train.py / eval.py
- [ ] 生成示例：影像分类（ResNet + dataloader）

### 2.4 初版运行器
- [ ] 内置“本地运行”脚本模板
- [ ] 支持输出日志与训练指标
- [ ] 最小 CLI：`python run_pipeline.py --config pipeline.json`

---

## 3. 多模态数据支持（M2）

### 3.1 数据输入节点
- [ ] DICOM 读取
- [ ] NIfTI / nii.gz 读取
- [ ] WSI (OpenSlide) 支持
- [ ] 文本 / 表格输入（CSV/JSON）

### 3.2 数据预处理节点
- [ ] 影像标准化/裁剪/重采样
- [ ] Patch / Tile 切片
- [ ] 文本清洗/Tokenize
- [ ] 结构化数据标准化

### 3.3 多模态融合节点
- [ ] Late Fusion / Early Fusion
- [ ] Cross-attention
- [ ] 可配置融合策略

---

## 4. 隐空间表征与基础模型（M3）

### 4.1 自监督/对比学习节点
- [ ] SimCLR / BYOL
- [ ] MAE / Masked Modeling
- [ ] 训练策略（冻结/微调）

### 4.2 降维与可视化节点
- [ ] PCA / UMAP / t-SNE
- [ ] 隐空间可视化（2D/3D）

### 4.3 基础模型节点
- [ ] MedCLIP / BioMedGPT / MedSAM
- [ ] 模型下载与缓存策略

### 4.4 表征复用
- [ ] 训练后特征缓存
- [ ] 下游任务直接加载隐空间

---

## 5. 插件体系与扩展（M4）

### 5.1 节点插件机制
- [ ] 插件目录结构规范
- [ ] 节点注册与热加载
- [ ] 自动生成 UI 参数面板

### 5.2 新模型快速接入流程
- [ ] 模板：模型定义 + config + 节点元数据
- [ ] 文档：如何新增节点（实验室成员）

---

## 6. 稳定性与教学支持

### 6.1 模板与示例库
- [ ] 影像分割模板
- [ ] 病理分类模板
- [ ] 多模态诊断模板

### 6.2 新手指引
- [ ] 交互式教程
- [ ] 常见错误修复说明

### 6.3 实验记录与报告
- [ ] 自动保存超参数
- [ ] 自动生成实验报告（PDF/Markdown）

---

## 7. 建议的开发节奏（可按周）

| 周期 | 目标 | 输出 |
|---|---|---|
| 第 1–2 周 | M0 | PRD + 架构设计 + 原型 |
| 第 3–5 周 | M1 | MVP 可用版 |
| 第 6–10 周 | M2 | 多模态支持 |
| 第 11–16 周 | M3 | 隐空间表征 + 基础模型 |
| 持续 | M4 | 插件生态 & 迭代 |

---

## 8. 推荐的团队分工（参考）

- **产品/需求**：场景分析 + PRD + 模板设计
- **前端**：节点画布 + UI/交互 + 插件面板
- **后端**：代码生成 + 运行器 + 模型注册
- **算法**：节点/模型/损失/数据预处理
- **运维**：环境打包 + 模型缓存 + 依赖管理

---

## 9. 下一步建议

- 选择 **M1** 的最小示例（如：影像分类）作为试点。
- 确定第一批节点列表（10–20 个核心节点）。
- 在实验室内部找 1–2 位新手试用，收集反馈。

